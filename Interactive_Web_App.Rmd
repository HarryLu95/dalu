---
title: <center><font face="Baskerville Old Face">**Interactive Web App**</font></center>
output: html_document
---
<div id="backhome"><a href="index.html"><i class="fa fa-home" aria-hidden="true"></i></a></div>
<div id="back"><a href="Projects.html"><i class="fa fa-undo" aria-hidden="true"></i></a></div>

#<font face="Baskerville Old Face">(I) Background</font>
<font face="Times New Roman" color=black size=4>

- Instructor: Peng Wang, AVP, Head of Data Science - Operation & Fraud Detection at MassMutual Financial Group
- The data set used in this project is ***gapminder*** from **bioconnector.org**. The data set includes the data of *Life Expectancy*, *Population*, *GDP per Capita* of all the countries of each continent from 1952 to 2007 with an interval of 5 years.
- <i class="fa fa-hand-o-right"></i> [Download Data](http://bioconnector.org/data/gapminder.csv)
- Multiple visulizations of the data set (Section II) and an interactive web application (Section III) were made in this project report.

</font>

#<font face="Baskerville Old Face">(II) Visulizations</font>
```{r Loading_Packages,message=FALSE}
library(dplyr)
library(readr)
library(stats)
library(knitr)
library(ggplot2)
library(tidyr)
gapminder=read.csv("http://bioconnector.org/data/gapminder.csv")
colnames(gapminder)=c("Country","Continent","Year","Life.Expectancy","Population","GDP.per.Capita")
```

##<font face="Baskerville Old Face">1. How many unique countries are represented per continent?</font>
```{r V1,fig.align="center"}
table.1=gapminder %>%
  group_by(Continent) %>%
  summarise(Country=n_distinct(Country))
kable(table.1,col.names=c("Continent","Country"),align="c")
ggplot(data=table.1)+
  geom_col(mapping=aes(Continent,Country),width=0.5)+
  ggtitle("Country Number of Each Continent")+
  xlab("Continent")+
  ylab("Country")+
  theme(plot.title=element_text(size=20,hjust=0.5))
```

##<font face="Baskerville Old Face">2. According to the data available, what was the average *Life Expectancy* across each continent from 1952 to 2007?</font>
```{r V2,fig.align="center"}
le=tapply(gapminder$Life.Expectancy,list(gapminder$Continent,gapminder$Year),mean)
le=data.frame(t(le))
Year=seq(from=1952,to=2007,by=5)
le=cbind(Year,le)
le=gather(data=le,Continent,Average.Life.Expectancy,-Year)
p1=ggplot(data=le,aes(x=Year,y=Average.Life.Expectancy,color=Continent))+
  geom_point()+
  geom_line()+
  ggtitle("Average Life Expectancy")+
  xlab("Year")+
  ylab("Life Expectancy (Years)")+
  theme(plot.title=element_text(size=20,hjust=0.5))
p1
```

###<font face="Baskerville Old Face">2.1 Life Expectancy for Every Countries in Americas</font>
```{r V2.1,fig.align="center"}
le.Americas=gapminder%>%filter(Continent=="Americas")
le.Americas=tapply(le.Americas$Life.Expectancy,list(le.Americas$Country,le.Americas$Year),mean)
le.Americas=t(data.frame(le.Americas))
row.names(le.Americas)=seq(1952,2007,5)
matplot(seq(1952,2007,5),le.Americas,type="l",lty=1,xlab="Years",ylab="Life Expectancy")
```

###<font face="Baskerville Old Face">2.2 Countries that have the **longest** average Life Expectancy in the world</font>
```{r V2.2,fig.align="center"}
lle=sort(tapply(gapminder$Life.Expectancy,gapminder$Country,mean),decreasing=TRUE)[1:5]
lle=as.data.frame(lle)
colnames(lle)="Average Life Expectancy"
kable(lle,align="c")
```

###<font face="Baskerville Old Face">2.3 Countries that have the **shortest** average Life Expectancy in the world</font>
```{r V2.3,fig.align="center"}
sle=sort(tapply(gapminder$Life.Expectancy,gapminder$Country,mean),decreasing=FALSE)[1:5]
sle=as.data.frame(sle)
colnames(sle)="Average Life Expectancy"
kable(sle,align="c")
```

##<font face="Baskerville Old Face">3. According to the data available, what was the average *Population* across each continent from 1952 to 2007?</font>
```{r V3,fig.align="center"}
pop=tapply(gapminder$Population,list(gapminder$Continent,gapminder$Year),mean)
pop=data.frame(t(pop))
Year=seq(from=1952,to=2007,by=5)
pop=cbind(Year,pop)
pop=gather(data=pop,Continent,Population,-Year)
p2=ggplot(data=pop,aes(x=Year,y=Population,color=Continent))+
  geom_point()+
  geom_line()+
  ggtitle("Average Population")+
  xlab("Year")+
  ylab("Population")+
  theme(plot.title=element_text(size=20,hjust=0.5))
p2
```

###<font face="Baskerville Old Face">3.1 Population for Every Countries in Americas</font>
```{r V3.1,fig.align="center"}
pop.Americas=gapminder%>%filter(Continent=="Americas")
pop.Americas=tapply(pop.Americas$Population,list(pop.Americas$Country,pop.Americas$Year),mean)
pop.Americas=t(data.frame(pop.Americas))
row.names(pop.Americas)=seq(1952,2007,5)
matplot(seq(1952,2007,5),pop.Americas,type="l",lty=1,xlab="Years",ylab="Population")
```

##<font face="Baskerville Old Face">4. According to the data available, what was the average *GDP per Capita* across each continent from 1952 to 2007?</font>
```{r V4,fig.align="center"}
gdp=tapply(gapminder$GDP.per.Capita,list(gapminder$Continent,gapminder$Year),mean)
gdp=data.frame(t(gdp))
Year=seq(from=1952,to=2007,by=5)
gdp=cbind(Year,gdp)
gdp=gather(data=gdp,Continent,GDP.per.Capita,-Year)
p3=ggplot(data=gdp,aes(x=Year,y=GDP.per.Capita,color=Continent))+
  geom_point()+
  geom_line()+
  ggtitle("Average GDP per Capita")+
  xlab("Year")+
  ylab("GDP per Capita")+
  theme(plot.title=element_text(size=20,hjust=0.5))
p3
```

###<font face="Baskerville Old Face">4.1 GDP Per Capita for Every Countries in Americas</font>
```{r V4.1,fig.align="center"}
gdp.Americas=gapminder%>%filter(Continent=="Americas")
gdp.Americas=tapply(gdp.Americas$GDP.per.Capita,list(gdp.Americas$Country,gdp.Americas$Year),mean)
gdp.Americas=t(data.frame(gdp.Americas))
row.names(gdp.Americas)=seq(1952,2007,5)
matplot(seq(1952,2007,5),gdp.Americas,type="l",lty=1,xlab="Years",ylab="GDP Per Capita")
legend("topleft",legend=c("Top 1: America","Top 2: Canada"),lty=1,col=3)
```